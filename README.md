# 📈 Investment Propensity Diagnosis & Custom Stock Recommendation Dashboard 📊
## 📊 투자성향 진단 및 맞춤형 종목 추천 대시보드
### URL : https://free-rider-beta.streamlit.app/

*사용자의 투자 성향을 진단하고, 그 결과에 맞춰 맞춤형 펀드 추천 및 개별 종목 분석을 제공하는 다중 페이지 Streamlit 웹 애플리케이션입니다.*

## 🌟 주요 기능 (Key Features)

### 🔑 사용자 인증 (User Authentication)
- 앱 접근 전 **로그인 및 회원가입** 기능 제공 (SQLite 데이터베이스를 활용한 사용자 계정 관리)
- 데모 계정 제공 (`아이디: beta`, `비밀번호: 1234`)
- 로그인 성공 시 자동으로 설문 페이지로 리디렉션

### 📝 투자성향 설문 (Questionnaire)
- 총 **7개의 문항**을 통해 사용자의 연령, 투자 기간, 경험, 위험 감수 수준 등을 파악
- 문항별 답변 진행률을 **실시간으로 시각화**하여 표시
- 모든 문항에 답변해야만 결과를 볼 수 있도록 **유효성 검사** 수행
- 설문 페이지로 다시 돌아올 때 **모든 설문 답변 및 진행 상황 자동 초기화** (깔끔한 재시작 경험 제공)
- **참고:** 설문 문항별 점수 체계는 기존 프로젝트와 다르게 구성되어 있습니다.

### 🔬 분석 애니메이션 (Analyzing Animation)
- 설문 제출 후, 결과 페이지로 넘어가기 전 분석이 진행되는 과정을 **시뮬레이션 애니메이션**으로 표시
- 사용자 경험(UX) 향상을 위한 대기 시간 연출

### 🎯 진단 결과 (Result Analysis)
- 설문 답변을 바탕으로 총점을 계산하고, **"안정형"부터 "공격투자형"**까지 5가지 투자 유형 중 하나로 분류
- 최종 투자 유형과 총점을 **시각적으로 강조**하여 표시
- **문항별 획득 점수**(막대그래프)와 **전체 투자성향 분포**(게이지 차트)를 Plotly를 통해 시각화
    - **참고:** 문항별 획득 점수 그래프는 실제 획득 점수를 반영하며 음수 값이 표시되지 않습니다.
- 진단 결과에 따른 투자 유형의 특징과 **추천 투자 상품 정보** 제공
- **'안정형' 진단 시**: 주식 종목 추천 대상이 아님을 명확히 안내하며, 설문 재시작 버튼만 제공
- **'안정형' 외 진단 시**: `04_dashboard.py` (맞춤형 추천 펀드 페이지)로 이동하는 버튼 제공

### 💰 투자성향 맞춤 추천 펀드 (Investment Propensity Matched Fund Recommendation) - `pages/04_dashboard.py`
- 사용자의 진단된 투자 성향(`investment_type`)에 따라 **최적화된 펀드형 포트폴리오(상위 10개 종목)**를 백테스팅 기반으로 자동 추천
- 추천 로직은 `target_class` (내부 분류 기준), `연간변동성` 분위수, `CAGR` (연간 복리 성장률)을 기반으로 하며, 각 투자성향별 조건은 다음과 같습니다:
    - **안정형**: `target_class` 0 & `vol_quartile` 1 (연간변동성 하위 25%)
    - **안정추구형**: `target_class` 0 또는 1 & `vol_quartile` 1 또는 2 (연간변동성 하위 50%)
    - **위험중립형**: `target_class` 0, 1 또는 2 & `vol_quartile` 1, 2 또는 3 (연간변동성 하위 75%)
    - **적극투자형/공격투자형**: `target_class` 0, 1, 2 또는 3 & `vol_quartile` 1, 2, 3 또는 4 (연간변동성 전체)

- 페이지 구성:
    1.  **📊 추천 펀드 성과 요약**: 추천된 펀드의 **평균 연간복리수익률 (CAGR)** 및 **평균 연간변동성** 등 핵심 성과 지표를 요약하여 표시합니다.
    2.  **📈 벤치마크 대비 성과 비교**:
        -   사용자 투자 성향에 해당하는 **추천 펀드의 연도별 CAGR**을 **꺾은선 그래프**로 표시합니다.
        -   **KOSPI, KOSDAQ, 국고채 3년 등 주요 벤치마크 수익률**을 **꺾은선 그래프**로 함께 표시하여 비교 분석합니다.
        -   모든 그래프는 **하나의 Y축 스케일**을 사용하여 데이터의 실제 비율 차이를 정확하게 보여줍니다.
    3.  **📈 백테스팅 전체 결과**:
        -   **모든 연도별, 모든 투자성향 Class 그룹(Class 0, 1, 2, 3)별 상위 10개 종목의 평균 CAGR**을 **막대 그래프**로 한눈에 보여줍니다.
        -   이때, **사용자의 진단된 투자성향 Class 그룹에 해당하는 막대만 컬러로 강조**하고, 나머지 Class 그룹의 막대는 흑백(회색)으로 표시하여 시각적 구분을 돕습니다.

- **추천 종목 상세 리스트 제공 안 함**: 연도별 상세 구성 종목 테이블 및 최신 추천 종목 리스트는 제공하지 않습니다.
- **"개별 종목 분석 및 포트폴리오 구성하기" 버튼**: 다음 페이지로 이동 시 추천된 종목들이 자동으로 포트폴리오에 추가됩니다.

### 📈 개별 종목 분석 및 포트폴리오 구성 (Individual Stock Analysis & Portfolio Building) - `pages/05_individual_stock_analysis.py`
- 전체 종목 리스트를 제공하며, 사용자가 직접 **투자성향 분류(`target_class`), 정렬 기준**(회사명, 배당수익률, CAGR, 연간변동성 등), **정렬 순서**를 선택하여 종목을 탐색
- **종목명 검색 기능**으로 원하는 종목을 빠르게 검색
- `st.data_editor`를 활용하여 **체크박스로 관심 종목**을 포트폴리오에 쉽게 추가/제거 (`상위 5개 추가 선택`, `모두 해제` 버튼 제공)
- 선택된 포트폴리오의 **평균 수익률**을 계산하고, 종목별 수익률을 **막대그래프**로 시각화하여 분석 결과 제공

### 🎨 UI/UX 일관성
- 모든 페이지에서 불필요한 Streamlit 기본 사이드바 내비게이션, 헤더, 푸터 등이 숨겨져 **깔끔하고 일관된 사용자 경험**을 제공합니다.

---

## 🛠️ 기술 스택 (Tech Stack)

이 프로젝트는 다음 기술 스택을 활용하여 개발되었습니다.

-   **프레임워크**: Streamlit
-   **데이터 처리**: Pandas, NumPy
-   **데이터 시각화**: Plotly
-   **데이터베이스**: SQLite3
-   **보안**: hashlib (비밀번호 해싱)
-   **언어**: Python

---

## 📚 학습점 (Learning Points)

이 프로젝트를 개발하면서 다음과 같은 기술적 경험과 학습을 할 수 있었습니다.

-   **Streamlit 기반 웹 애플리케이션 개발:**
    -   다중 페이지(Multi-page) Streamlit 앱 구조 설계 및 페이지 간 전환 로직 구현.
    -   `st.session_state`를 활용하여 사용자 세션 및 설문 상태를 효율적으로 관리하는 방법 이해 및 적용.
    -   다양한 Streamlit 위젯(버튼, 슬라이더, 텍스트 입력 등)의 활용 및 동적 UI 업데이트 구현.
    -   `st.data_editor`를 이용한 테이블 데이터 편집 및 상호작용 기능 구현.
    -   Streamlit 기본 UI 요소(사이드바, 헤더, 푸터)를 제어하여 깔끔하고 일관된 사용자 경험(UX) 제공.

-   **데이터 처리 및 분석:**
    -   Pandas를 활용한 대규모 데이터 로딩, 전처리(특히 **2017년 이후 데이터 필터링**), 필터링, 정렬 기법 숙달.
    -   사용자 설문 기반의 투자성향 진단 로직(점수 계산, 유형 분류) 설계 및 구현.
    -   **백테스팅을 통한 맞춤형 펀드 추천 로직** 설계 (연도별 `target_class`, `연간변동성` 분위수, `CAGR` 기준 적용).
    -   재무 데이터를 기반으로 한 종목 필터링 및 포트폴리오 수익률 계산 로직 개발.

-   **데이터 시각화:**
    -   Plotly 라이브러리를 이용하여 동적이고 상호작용 가능한 막대그래프, 게이지 차트, **꺾은선 그래프** 등 다양한 데이터 시각화 구현.
    -   **복합 차트 (막대 + 꺾은선)**를 하나의 그래프에 구현하고, **단일 Y축 스케일**로 데이터의 실제 비율을 정확하게 표현하는 방법 학습.
    -   특정 데이터 포인트를 **조건부로 색상 강조(컬러 vs 흑백)**하여 사용자의 관심사를 시각적으로 부각하는 방법 학습.
    -   분석 결과를 시각적으로 효과적으로 전달하고, 사용자 이해도를 높이는 방법 학습.

-   **데이터베이스 및 보안:**
    -   SQLite3를 활용하여 경량 데이터베이스를 설계하고 사용자 계정 정보(ID, 비밀번호)를 저장 및 관리.
    -   `hashlib` 모듈을 이용한 비밀번호 해싱 처리로 기본적인 사용자 인증 시스템 보안 강화.

-   **코드 모듈화 및 프로젝트 관리:**
    -   `utils.py`와 같은 공통 함수 모듈 분리를 통해 코드 재사용성과 유지보수성을 향상.
    -   Git을 활용한 효율적인 버전 관리 및 협업(가상) 경험.
    -   `requirements.txt`를 통한 프로젝트 의존성 관리 및 환경 설정 자동화.

-   **사용자 경험(UX) 개선 고려:**
    -   설문 진행률 시각화, 분석 애니메이션 등을 통해 사용자의 대기 시간을 즐겁게 하고, 직관적인 피드백 제공.
    -   유효성 검사를 통해 사용자 오류를 줄이고, 깔끔한 재시작 경험을 제공.

---

## 📂 프로젝트 구조 (Project Structure)

포트폴리오용으로 정리한 구조입니다. 데이터는 `data/`, 정적 자산은 `assets/`에 두었습니다.

```
.
├── app.py                     # 🔑 로그인/회원가입 (앱 진입점)
├── pages/
│   ├── 01_questionnaire.py    # 📝 투자성향 진단 설문
│   ├── 02_analyzing.py        # 🔬 분석 중 애니메이션
│   ├── 03_result.py           # 🎯 진단 결과
│   ├── 03_1_kyc_rule.py       # ⚠️ 투자 전 확인사항 (KYC)
│   ├── 04_dashboard.py        # 💰 맞춤형 추천 펀드
│   └── 05_individual_stock_analysis.py  # 📈 개별 종목 분석·포트폴리오
├── utils.py                   # ⚙️ 공통 로직 (설문, 점수, 데이터 로딩, 추천)
├── data/
│   └── stock_dataset.xlsx     # 💰 종목·펀드 분석용 데이터 (필수)
├── assets/                    # 분석 중 페이지 아이콘 (brain_icon.png 선택, 없으면 이모지 사용)
├── requirements.txt
└── .gitignore                 # user_data.db 등 제외
```

- **user_data.db**: 로그인 계정 저장용 SQLite. 앱 실행 시 `data/` 폴더에 자동 생성되며, `.gitignore`로 버전 관리에서 제외됩니다.

---

## ⚙️ 설치 및 실행 방법 (Installation & Usage)

### 1. 프로젝트 클론 (Clone the repository)

```bash
git clone https://github.com/your-username/your-repository-name.git
cd your-repository-name
```
(위 `https://github.com/your-username/your-repository-name.git`은 실제 GitHub 저장소 URL로 변경해주세요.)

### 2. 가상 환경 생성 및 활성화 (Create and activate a virtual environment - Recommended)

#### Windows
```bash
python -m venv venv
.\venv\Scripts\activate
```

#### macOS / Linux
```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. 필요한 라이브러리 설치 (Install required libraries)

```bash
pip install -r requirements.txt
```

### 4. 데이터 파일 준비 (Prepare the data file)

`data/` 폴더에 **stock_dataset.xlsx** 파일이 있어야 합니다. (저장소에 포함된 샘플을 사용하거나, 동일 컬럼 구조의 엑셀을 해당 이름으로 넣으면 됩니다.)  
필수 컬럼은 `utils.py`에 정의된 이름과 일치해야 합니다:

-   `회사명`
-   `거래소코드`
-   `회계년도` (2017년 이후 데이터가 로드되고 분석에 활용됩니다.)
-   `이자보상배율(이자비용)`
-   `영업활동으로 인한 현금흐름(*)(천원)`
-   `연간변동성`
-   `CAGR` (연간 복리 성장률)
-   `target_class` (0, 1, 2, 3으로 분류된 투자성향 분류 코드)
-   (선택 사항) `배당수익률` - 없으면 랜덤 값 생성 로직이 작동합니다.

### 5. Streamlit 앱 실행 (Run the Streamlit app)

```bash
streamlit run --clear-cache app.py
```

명령어를 실행하면 웹 브라우저에서 자동으로 애플리케이션이 열립니다.

---

## 🔄 애플리케이션 흐름 (Application Flow)

1.  **로그인/회원가입** (`app.py`): 앱의 첫 진입점. 사용자 인증을 수행합니다.
2.  **투자성향 설문** (`pages/01_questionnaire.py`): 로그인 후 이동하는 메인 페이지. 7개 문항 설문을 진행합니다.
3.  **분석 중...** (`pages/02_analyzing.py`): 설문 제출 후, 다음 페이지로 이동하기 전 분석 과정을 시뮬레이션합니다.
4.  **진단 결과** (`pages/03_result.py`): 분석된 투자성향 결과와 상세 그래프를 확인합니다. '안정형'이 아니면 **투자 전 확인사항(KYC)** (`pages/03_1_kyc_rule.py`)을 거친 뒤 맞춤형 추천 펀드로 이동하고, '안정형'인 경우 설문 재시작 버튼만 제공합니다.
5.  **투자성향 맞춤 추천 펀드** (`pages/04_dashboard.py`):
    -   회원님의 투자성향에 맞는 **펀드 성과 요약**을 표시합니다.
    -   이어서, 추천 펀드와 주요 벤치마크의 연도별 수익률을 **꺾은선 그래프**로 비교하는 차트가 나타납니다.
    -   그 다음, 백테스팅의 **전체 결과(모든 Class 그룹의 연도별 CAGR)**를 막대 그래프로 보여주며, 사용자 성향에 맞는 Class 그룹은 색상으로 강조됩니다.
    -   마지막으로, '개별 종목 분석 및 포트폴리오 구성' 페이지로 이동하는 버튼을 제공합니다.
6.  **개별 종목 분석 및 포트폴리오 구성** (`pages/05_individual_stock_analysis.py`): 전체 종목 리스트에서 필터, 정렬, 검색을 통해 원하는 종목을 탐색하고, 자신만의 포트폴리오를 구성하여 분석할 수 있습니다.

---

## 📸 스크린샷 (Screenshots)

> 💡 **Tip**: 로그인 페이지, 설문 페이지, 결과 페이지, 추천 펀드 페이지, 개별 종목 대시보드 등 주요 화면의 실제 스크린샷을 추가하여 프로젝트의 시각적 매력을 높여보세요!

---

## 🤝 기여하기 (Contributing)

프로젝트에 기여하고 싶으시다면, 언제든지 Pull Request를 통해 참여해 주십시오.

---

## 📞 문의 (Contact)

질문이나 제안사항이 있으시면 언제든 연락주세요!

-   📧 이메일: eogkswndtk@naver.com

---

⭐ **이 프로젝트가 도움이 되셨다면 별표(Star)를 눌러주세요!**
